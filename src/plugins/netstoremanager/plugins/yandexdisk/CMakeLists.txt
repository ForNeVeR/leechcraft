CMAKE_MINIMUM_REQUIRED (VERSION 2.8)
PROJECT (leechcraft_netstoremanager_yandexdisk)
INCLUDE (InitLCPlugin OPTIONAL)

INCLUDE_DIRECTORIES (${NETSTOREMANAGER_INCLUDE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
	${CMAKE_CURRENT_SOURCE_DIR}
	${LEECHCRAFT_INCLUDE_DIR}
	)

SET (YANDEXDISK_SRCS
	yandexdisk.cpp
	account.cpp
	uploadmanager.cpp
	authmanager.cpp
	urls.cpp
	flgetter.cpp
	flitem.cpp
	common.cpp
	simpleactor.cpp
	actorbase.cpp
	)
SET (YANDEXDISK_HEADERS
	yandexdisk.h
	account.h
	uploadmanager.h
	authmanager.h
	urls.h
	flgetter.h
	flitem.h
	common.h
	simpleactor.h
	actorbase.h
	)
SET (YANDEXDISK_FORMS
	)
SET (YANDEXDISK_RESOURCES netstoremanageryandexdiskresources.qrc)
CreateTrVars ("netstoremanager_yandexdisk" "en;ru_RU;uk_UA" YANDEXDISK_TRANSLATIONS YANDEXDISK_COMPILED_TRANSLATIONS)

IF (NOT LC_NO_MOC)
	QT4_WRAP_CPP (YANDEXDISK_MOC_SRCS ${YANDEXDISK_HEADERS})
ENDIF (NOT LC_NO_MOC)
#QT4_WRAP_UI (YANDEXDISK_UIS_H ${YANDEXDISK_FORMS})
QT4_ADD_RESOURCES (YANDEXDISK_RCCS ${YANDEXDISK_RESOURCES})

ADD_CUSTOM_COMMAND (OUTPUT
	${YANDEXDISK_COMPILED_TRANSLATIONS}
	COMMAND "${QT_LRELEASE_EXECUTABLE}" ${YANDEXDISK_TRANSLATIONS}
	DEPENDS ${YANDEXDISK_TRANSLATIONS}
	WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
	)
ADD_LIBRARY (leechcraft_netstoremanager_yandexdisk SHARED
	${YANDEXDISK_COMPILED_TRANSLATIONS}
	${YANDEXDISK_SRCS}
	${YANDEXDISK_MOC_SRCS}
	${YANDEXDISK_UIS_H}
	${YANDEXDISK_RCCS}
	)
TARGET_LINK_LIBRARIES (leechcraft_netstoremanager_yandexdisk
	${QT_LIBRARIES}
	${LEECHCRAFT_LIBRARIES}
	)

INSTALL (TARGETS leechcraft_netstoremanager_yandexdisk DESTINATION ${LC_PLUGINS_DEST})
INSTALL (FILES ${YANDEXDISK_COMPILED_TRANSLATIONS} DESTINATION ${LC_TRANSLATIONS_DEST})
#INSTALL (FILES netstoremanageryandexdisksettings.xml DESTINATION ${LC_SETTINGS_DEST})
